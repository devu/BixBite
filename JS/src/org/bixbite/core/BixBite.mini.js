var bixbite={version:"0.9.5",trans:null,prefix:null};(function(){var a=navigator.userAgent;0<=a.indexOf("Trident")||0<=a.indexOf("MSIE")?(bixbite.trans="msTransform",bixbite.prefix="-ms-"):0<=a.indexOf("Firefox")?(bixbite.trans="transform",bixbite.prefix="-moz-"):0<=a.indexOf("AppleWebKit")?(bixbite.trans="webkitTransform",bixbite.prefix="-webkit-"):0<=a.indexOf("Opera")&&(bixbite.trans="OTransform",bixbite.prefix="-o-")})(); var trace=function(){"undefined"!=typeof console&&console.log(Array.prototype.join.call(arguments," "))},getTimer=function(){return Date.now()||new Date},uintToHex=function(a){a=a.toString(16);return"#000000".slice(0,-a.length)+a},parseVal=function(a){if(isNaN(a))return a;var b=a.toString();return 0<=b.indexOf("%")?b:a+"px"},Class=function(a){},p=Class.prototype;Function.prototype.extend=function(a){Class.prototype=a.prototype;this.prototype=new Class(a);this.prototype.constructor=this;return this.prototype}; Event={RESIZE:"resize",COMPLETE:"complete"};MouseEvent={CLICK:"click",DOUBLE_CLICK:"dblclick",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_OVER:"mouseover",MOUSE_UP:"mouseup"};TouchEvent={TAP:"click",TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend"};function Compound(){}p=Compound.prototype;p.register=function(a,b){this.e.reg(a,b)};p.unregister=function(a){this.e.unr(a)}; p.addBehaviour=function(a,b,c,h){this[a]=new b;this[a].initialise(this.e,a,c,this);h&&this[a].execute(this.s)};p.removeBehaviour=function(a){this[a].dispose();this[a]=null;delete this[a]};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chT,a,this.s)};p.emitSignal=function(a,b,c){this.s.params=b;c?this.e.brcm("C",a,this.s,this):this.e.brc(this.chC,a,this.s,this)};function Data(){}p=Data.prototype;p.addSlot=function(a,b){this.e.asl(this.chD,this.uid,a,b,this)}; p.removeSlot=function(a){this.e.rsl(this.chD,this.uid,a)};p.responseTo=function(a,b,c){this.e.snd(this.chC,a,b,c?c:this)};p.responseToAll=function(a,b){this.e.brc(this.chC,a,b?b:this)};p.destroy=function(){this.e.ras(this.chD,this.uid)};function Transponder(){}p=Transponder.prototype;p.addSlot=function(a,b){this.e.asl(this.chT,this.uid,a,b,this)};p.removeSlot=function(a){this.e.rsl(this.chT,this.uid,a)};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chC,a,this.s)}; p.transmit=function(a){this.e.asl(this.chT,this.uid,a,function(b){this.e.brc(this.chC,a,b)})};p.responseToAll=function(a,b){this.s.params=b;this.e.brc(this.chV,a,this.s)};p.responseTo=function(a,b,c){this.s.params=c;this.e.snd(this.chV,a,b,this.s)};p.getSlots=function(a){return this.chC[a]};p.addSensor=function(a,b,c){var h=this;a.body["on"+b]=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return c.apply(h,arguments)}};p.removeSensor=function(a,b,c){a.body["on"+b]=null}; p.getContext=function(a){return this.e.bb.getCtx(a)};function View(){}p=View.prototype;p.addSlot=function(a,b){this.e.asl(this.chV,this.uid,a,b,this)};p.removeSlot=function(a){this.rsl(this.chV,this.uid,a)};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chT,a,this.s)};p.emitSignal=function(a,b){this.s.params=b;this.e.brc(this.chV,a,this.s)};p.emitSignalTo=function(a,b,c){this.s.params=c;this.e.snd(this.chV,a,b,this.s)};p.getSlots=function(a){return this.chT[a]}; p.registerContext=function(a,b){return this.e.bb.regCtx(this,a,b)};p.unregisterContext=function(a){this.e.bb.unrCtx(a)};p.getContext=function(a){return this.e.bb.getCtx(a)};function Behaviour(){}p=Behaviour.prototype;p.initialise=function(a,b,c,h){this.e=a;this.uid=a.uid();this.s=this.e.add(this.uid);this.t=b;this.chC=a.chC;this.chD=a.chD;this.chT=a.chT;this.chV=a.chV;this.aDis=c;this.c=h;this.e.asl(this.chC,this.uid,b,this.execute,this);this.init()};p.register=function(a,b){this.e.reg(a,b)}; p.unregister=function(a){this.e.unr(a)};p.addResponder=function(a,b,c){this.e.asl(this.chC,this.uid,a,b,this);c&&this.sendRequest(a)};p.removeResponder=function(a){this.e.ras(this.chC,a)};p.sendRequest=function(a,b){this.s.params=b;this.e.brc(this.chD,a,this.s)};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chV,a,this.s)};p.sendSignalTo=function(a,b,c){this.s.params=c;this.e.snd(this.chV,a,b,this.s)}; p.emitSignal=function(a,b,c){this.s.params=b;c?this.e.brcm("C",a,this.s,this):this.e.brc(this.chC,a,this.s,this)};p.getSlots=function(a){return this.chV[a]};function Context(a){this.parent=a;this.body=document.createElement("div");gl=new Graphics(this.body)}p=Context.prototype;p.init=function(){};p.dispose=function(){};p.addChild=function(a){this.body.appendChild(a.body);return a};p.removeChild=function(a){this.body.removeChild(a.body);return a}; function BixBite(a){function b(a){this.callerUID=a}function c(a,e){this.uid=a;this.send=e}function h(){var a,e,b=-1;this.asl=function(d,f){var l=new c(d,f);l.i=++b;a?a.n=l:e=l;a=l};this.rsl=function(d){for(var f=e,c;f.n&&f.uid!=d;)c=f,f=f.n;c&&f.n&&(c.n=f.n);f.dispose();b--;0>b&&(a=e=null)};this.brc=function(a){for(var b=e;b.n;)b.send.call(b.send._c,a),b=b.n;b.send.call(b.send._c,a)};this.gsl=function(a){for(var b=e;b.n;){if(b.uid==a)return b;b=b.n}return b.uid==a?b:null};this.ras=function(){for(var d= e,f;d.n;)f=d.n,BixBite.dispose(d),b--,d=f;BixBite.dispose(e);BixBite.dispose(a);e=a=null;b--};this.num=function(){return b+1}}function m(){var a=-1;this.chC={};this.chD={};this.chT={};this.chV={};this.add=function(a){return new b(a)};this.reg=function(a,n){if(n&&null!=this[a.uid])this[a.uid].copies++;else{var d=this.uid();this[d]=new a;this[d].uid=d;this[d].s=new b(d);this[d].e=this;this[d].chC=this.chC;this[d].chD=this.chD;this[d].chT=this.chT;this[d].chV=this.chV;this[d].init()}};this.unr=function(a){this[a]&& (0<this[a].cps?this[a].cps--:(this[a].destroy(),this[a]=null,delete this[a]))};this.asl=function(a,b,d,f,c){a[d]||(a[d]=new h);f._c=c;a[d].asl(b,f)};this.rsl=function(a,b,d){var f=a[d];f&&f.gsl(b)&&(f.rsl(b),0==f.num()&&delete a[d])};this.brcm=function(a,b,d){this.chE(a,b,d)};this.brc=function(a,b,d){a[b]&&a[b].brc(d)};this.snd=function(a,b,d,f){a[d]&&(a=a[d].gsl(b))&&a.send.call(a.send._c,f)};this.ras=function(a,b){a[b]&&(a[b].ras(),BixBite.dispose(a[b]))};this.uid=function(){return"@"+ ++a+"::"+ this.cid}}function q(a){var e=this.e=new m;e.cid=a;var c=e.chC;a=e.uid()+a;var d=new b(a);brc=function(a,b,d){e.brc(e["ch"+a],b,d)};this.register=function(a){e.reg(a,!0)};this.unregister=function(a){e.unr(a)};this.emitSignal=function(a,b){d.params=b;e.brc(c,a,d)}}this.root=a;var k={},g={};this.spawnCore=function(a){var b=new q(a);b.e.chE=function(a,b,e){for(var c in k)c.brc(a,b,e)};b.e.bb=this;return k[a]=b};this.destroyCore=function(a){k[a]&&(this.dispose(k[a]),delete k[a])};this.getCtx=function(a){return g[a]}; this.addContext=this.addCtx=function(b,e){e.id=b;a.addChild(e);g[b]=e;e.init()};this.regCtx=function(a,b,c){g[b]&&alert("Context id:'"+b+"' is already registered.");c=new c;c.view=a;c.id=b;g[b]=c;c.init();return c};this.unrCtx=function(a){g[a]||alert("Context id:'"+a+"' doesn't exist.");var b=g[a];b&&b.parentNode&&(b.parentNode.removeChild(b),b.view=null,b.dispose());this.dispose(g[a]);delete g[a]}} BixBite.prototype.dispose=function(a){a.hasOwnProperty("destroy")&&a.destroy();for(var b in a)a.hasOwnProperty(b)&&delete a[b]};