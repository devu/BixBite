var trace=function(){console.log(Array.prototype.join.call(arguments," "))},getTimer=function(){return Date.now()||new Date},Class=function(){},p=Class.prototype;Function.prototype.extend=function(a){Class.prototype=a.prototype;this.prototype=new Class(a);this.prototype.constructor=this;return this.prototype};function Compound(){}p=Compound.prototype;p.register=function(a,b){this.e.reg(a,b)};p.unregister=function(a){this.e.unt(a)}; p.addBehaviour=function(a,b,c,h){this[a]=new b;this[a].initialise(this.e,a,c,this);h&&this[a].execute(this.s)};p.removeBehaviour=function(a){this[a].dispose();this[a]=null;delete this[a]};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chT,a,this.s)};p.emitSignal=function(a,b,c){this.s.params=b;!c?this.e.brc(this.chC,a,this.s,this):this.e.brcm("C",a,this.s,this)};function Data(){}p=Data.prototype;p.addSlot=function(a,b){this.e.asl(this.chD,this.uid,a,b,this)}; p.removeSlot=function(a){this.e.rsl(this.chD,this.uid,a)};p.responseTo=function(a,b,c){this.e.snd(this.chC,a,b,c?c:this)};p.responseToAll=function(a,b){this.e.brc(this.chC,a,b?b:this)};function Transponder(){}p=Transponder.prototype;p.addSlot=function(a,b){this.e.asl(this.chT,this.uid,a,b,this)};p.removeSlot=function(a){this.e.rsl(this.chT,this.uid,a)};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chC,a,this.s)}; p.transmit=function(a){this.e.asl(this.chT,this.uid,a,function(b){this.e.brc(this.chC,a,b)})};p.responseToAll=function(a,b){this.s.params=b;this.e.brc(this.chV,a,this.s)};p.responseTo=function(a,b,c){this.s.params=c;this.e.snd(this.chV,a,b,this.s)};p.getSlots=function(a){return this.chC[a]};p.addSensor=function(a,b){var c=this;document.body.addEventListener(a,function(){return b.apply(c,arguments)},!1)};p.removeSensor=function(a,b){document.body.removeEventListener(a,b)};function View(){}p=View.prototype; p.addSlot=function(a,b){this.e.asl(this.chV,this.uid,a,b,this)};p.removeSlot=function(a){this.rsl(this.chV,this.uid,a)};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chT,a,this.s)};p.emitSignal=function(a,b){this.s.params=b;this.e.brc(this.chV,a,this.s)};p.emitSignalTo=function(a,b,c){this.s.params=c;this.e.snd(this.chV,a,b,this.s)};p.getSlots=function(a){return this.chT[a]};function Behaviour(){}p=Behaviour.prototype; p.initialise=function(a,b,c,h){this.e=a;this.uid=a.uid();this.s=this.e.add(this.uid);this.t=b;this.chC=a.chC;this.chD=a.chD;this.chT=a.chT;this.chV=a.chV;this.aDis=c;this.c=h;this.e.asl(this.chC,this.uid,b,this.execute,this);this.init()};p.register=function(a,b){this.e.reg(a,b)};p.unregister=function(a){this.e.unr(a)};p.addResponder=function(a,b,c){this.e.asl(this.chC,this.uid,a,b,this);c&&this.sendRequest(a)};p.removeResponder=function(a){this.e.ras(this.chC,a)}; p.sendRequest=function(a,b){this.s.params=b;this.e.brc(this.chD,a,this.s)};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chV,a,this.s)};p.sendSignalTo=function(a,b,c){this.s.params=c;this.e.snd(this.chV,a,b,this.s)};p.emitSignal=function(a,b,c){this.s.params=b;!c?this.e.brc(this.chC,a,this.s,this):this.e.brcm("C",a,this.s,this)};p.getSlots=function(a){return this.chV[a]}; function BixBite(){function a(a){this.callerUID=a}function b(a,f){this.uid=a;this.send=f}function c(){var a,f,g=-1;this.asl=function(d,e){var c=new b(d,e);c.i=++g;a?a.n=c:f=c;a=c};this.rsl=function(b){for(var e=f,c;e.n&&e.uid!=b;)c=e,e=e.n;c&&e.n&&(c.n=e.n);e.dispose();g--;0>g&&(a=f=null)};this.brc=function(a){for(var b=f;b.n;)b.send.call(b.send._c,a),b=b.n;b.send.call(b.send._c,a)};this.gsl=function(a){for(var b=f;b.n;){if(b.uid==a)return b;b=b.n}return b.uid==a?b:null};this.ras=function(){for(var b= f,e;b.n;)e=b.n,dispose(b),g--,b=e;dispose(f);dispose(a);f=a=null;g--};this.num=function(){return g+1}}function h(){var b=-1;this.chC={};this.chD={};this.chT={};this.chV={};this.add=function(b){return new a(b)};this.reg=function(b,c){if(c&&null!=this[b.uid])this[b.uid].copies++;else{var d=this.uid();this[d]=new b;this[d].uid=d;this[d].s=new a(d);this[d].e=this;this[d].chC=this.chC;this[d].chD=this.chD;this[d].chT=this.chT;this[d].chV=this.chV;this[d].init()}};this.unr=function(a){this[a]&&(0<this[a].cps? this[a].cps--:(this[a].destroy(),this[a]=null,delete this[a]))};this.asl=function(a,b,d,e,k){a[d]||(a[d]=new c(d));e._c=k;a[d].asl(b,e)};this.rsl=function(a,b,c){var e=a[c];e&&e.gsl(b)&&(e.rsl(b),0==e.num()&&delete a[c])};this.brcm=function(a,b,c){this.chE(a,b,c)};this.brc=function(a,b,c){a[b]&&a[b].brc(c)};this.snd=function(a,b,c,e){a[c]&&(a=a[c].gsl(b))&&a.send.call(a.send._c,e)};this.uid=function(){return"@"+ ++b+"::"+this.cid};this.ras=function(a,b){if(!a[b])return a[b].ras();dispose(a[b])}}function l(b){var c= this.e=new h;c.cid=b;var g=c.chC;b=c.uid()+b;var d=new a(b);brc=function(a,b,d){c.brc(c["ch"+a],b,d)};this.register=function(a){c.reg(a,!0)};this.unregister=function(a){c.unr(a)};this.emitSignal=function(a,b){d.params=b;c.brc(g,a,d)}}var j={};list={};getContainer=function(a){return list[a]};this.spawnCore=function(a){var b=new l(a);b.e.chE=function(a,b,c){for(var f in j)f.brc(a,b,c)};b.e.bb=this;return j[a]=b};this.destroyCore=function(a){j[a]&&(this.dispose(j[a]),delete j[a])};this.addContextRoot= function(a,b){list[a]=b}}BixBite.prototype.dispose=function(a){for(var b in a)a.hasOwnProperty("destroy")&&a.destroy(),a.hasOwnProperty(b)&&(a[b]=null,delete a[b]);delete null};