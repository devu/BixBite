//2.29KB gzipped (7.1KB uncompressed)
var bixbite={version:"0.9.5",trans:null,prefix:null};(function(){var a=navigator.userAgent;0<=a.indexOf("Trident")||0<=a.indexOf("MSIE")?(bixbite.trans="msTransform",bixbite.prefix="-ms-"):0<=a.indexOf("Firefox")?(bixbite.trans="transform",bixbite.prefix="-moz-"):0<=a.indexOf("AppleWebKit")?(bixbite.trans="webkitTransform",bixbite.prefix="-webkit-"):0<=a.indexOf("Opera")&&(bixbite.trans="OTransform",bixbite.prefix="-o-")})(); var trace=function(){"undefined"!=typeof console&&console.log(Array.prototype.join.call(arguments," "))},getTimer=function(){return Date.now()||new Date},uintToHex=function(a){a=a.toString(16);return"#000000".slice(0,-a.length)+a},parseVal=function(a){if(isNaN(a))return a;var b=a.toString();return 0<=b.indexOf("%")?b:a+"px"},Class=function(a){},p=Class.prototype;Function.prototype.extend=function(a){Class.prototype=a.prototype;this.prototype=new Class(a);this.prototype.constructor=this;return this.prototype}; Event={RESIZE:"resize",COMPLETE:"complete"};MouseEvent={CLICK:"click",DOUBLE_CLICK:"dblclick",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_OVER:"mouseover",MOUSE_UP:"mouseup"};TouchEvent={TAP:"click",TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend"};function Compound(){}p=Compound.prototype;p.register=function(a,b){this.e.reg(a,b)};p.unregister=function(a){this.e.unr(a)}; p.addBehaviour=function(a,b,d,g){this[a]=new b;this[a].initialise(this.e,a,d,this);g&&this[a].execute(this.s)};p.removeBehaviour=function(a){this[a].dispose();this[a]=null;delete this[a]};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chT,a,this.s)};p.emitSignal=function(a,b,d){this.s.params=b;d?this.e.brcm("C",a,this.s,this):this.e.brc(this.chC,a,this.s,this)};function Data(){}p=Data.prototype;p.addSlot=function(a,b){this.e.asl(this.chD,this.uid,a,b,this)}; p.removeSlot=function(a){this.e.rsl(this.chD,this.uid,a)};p.responseTo=function(a,b,d){this.e.snd(this.chC,a,b,d?d:this)};p.responseToAll=function(a,b){this.e.brc(this.chC,a,b?b:this)};p.destroy=function(){this.e.ras(this.chD,this.uid)};function Transponder(){}p=Transponder.prototype;p.addSlot=function(a,b){this.e.asl(this.chT,this.uid,a,b,this)};p.removeSlot=function(a){this.e.rsl(this.chT,this.uid,a)};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chC,a,this.s)}; p.transmit=function(a){this.e.asl(this.chT,this.uid,a,function(b){this.e.brc(this.chC,a,b)})};p.responseToAll=function(a,b){this.s.params=b;this.e.brc(this.chV,a,this.s)};p.responseTo=function(a,b,d){this.s.params=d;this.e.snd(this.chV,a,b,this.s)};p.getSlots=function(a){return this.chC[a]};p.addSensor=function(a,b,d){var g=this;a.body["on"+b]=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return d.apply(g,arguments)}};p.removeSensor=function(a,b,d){a.body["on"+b]=null}; p.getContext=function(a){return this.e.bb.getCtx(a)};function View(){}p=View.prototype;p.addSlot=function(a,b){this.e.asl(this.chV,this.uid,a,b,this)};p.removeSlot=function(a){this.rsl(this.chV,this.uid,a)};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chT,a,this.s)};p.emitSignal=function(a,b){this.s.params=b;this.e.brc(this.chV,a,this.s)};p.emitSignalTo=function(a,b,d){this.s.params=d;this.e.snd(this.chV,a,b,this.s)};p.getSlots=function(a){return this.chT[a]}; p.registerContext=function(a,b){return this.e.bb.regCtx(a,b,this)};p.unregisterContext=function(a){this.e.bb.unrCtx(a)};p.getContext=function(a){return this.e.bb.getCtx(a)};function Behaviour(){}p=Behaviour.prototype;p.initialise=function(a,b,d,g){this.e=a;this.uid=a.uid();this.s=this.e.add(this.uid);this.t=b;this.chC=a.chC;this.chD=a.chD;this.chT=a.chT;this.chV=a.chV;this.aDis=d;this.c=g;this.e.asl(this.chC,this.uid,b,this.execute,this);this.init()};p.register=function(a,b){this.e.reg(a,b)}; p.unregister=function(a){this.e.unr(a)};p.addResponder=function(a,b,d){this.e.asl(this.chC,this.uid,a,b,this);d&&this.sendRequest(a)};p.removeResponder=function(a){this.e.ras(this.chC,a)};p.sendRequest=function(a,b){this.s.params=b;this.e.brc(this.chD,a,this.s)};p.sendSignal=function(a,b){this.s.params=b;this.e.brc(this.chV,a,this.s)};p.sendSignalTo=function(a,b,d){this.s.params=d;this.e.snd(this.chV,a,b,this.s)}; p.emitSignal=function(a,b,d){this.s.params=b;d?this.e.brcm("C",a,this.s,this):this.e.brc(this.chC,a,this.s,this)};p.getSlots=function(a){return this.chV[a]};function Context(a){this.parent=a;this.body=document.createElement("div");gl=new Graphics(this.body)}p=Context.prototype;p.init=function(){};p.dispose=function(){};p.addChild=function(a){this.body.appendChild(a.body);return a};p.removeChild=function(a){this.body.removeChild(a.body);return a};p.setID=function(a){this.body.id=a}; function BixBite(a){function b(a){this.callerUID=a}function d(a,f){this.uid=a;this.send=f}function g(){var a,f,b=-1;this.asl=function(c,e){var l=new d(c,e);l.i=++b;a?a.n=l:f=l;a=l};this.rsl=function(c){for(var e=f,d;e.n&&e.uid!=c;)d=e,e=e.n;d&&e.n&&(d.n=e.n);e.dispose();b--;0>b&&(a=f=null)};this.brc=function(a){for(var b=f;b.n;)b.send.call(b.send._c,a),b=b.n;b.send.call(b.send._c,a)};this.gsl=function(a){for(var b=f;b.n;){if(b.uid==a)return b;b=b.n}return b.uid==a?b:null};this.ras=function(){for(var c= f,e;c.n;)e=c.n,BixBite.dispose(c),b--,c=e;BixBite.dispose(f);BixBite.dispose(a);f=a=null;b--};this.num=function(){return b+1}}function m(){var a=-1;this.chC={};this.chD={};this.chT={};this.chV={};this.add=function(a){return new b(a)};this.reg=function(a,d){if(d&&null!=this[a.uid])this[a.uid].copies++;else{var c=this.uid();this[c]=new a;this[c].uid=c;this[c].s=new b(c);this[c].e=this;this[c].chC=this.chC;this[c].chD=this.chD;this[c].chT=this.chT;this[c].chV=this.chV;this[c].init()}};this.unr=function(a){this[a]&& (0<this[a].cps?this[a].cps--:(this[a].destroy(),this[a]=null,delete this[a]))};this.asl=function(a,b,c,e,d){a[c]||(a[c]=new g);e._c=d;a[c].asl(b,e)};this.rsl=function(a,b,c){var e=a[c];e&&e.gsl(b)&&(e.rsl(b),0==e.num()&&delete a[c])};this.brcm=function(a,b,c){this.chE(a,b,c)};this.brc=function(a,b,c){a[b]&&a[b].brc(c)};this.snd=function(a,b,c,e){a[c]&&(a=a[c].gsl(b))&&a.send.call(a.send._c,e)};this.ras=function(a,b){a[b]&&(a[b].ras(),BixBite.dispose(a[b]))};this.uid=function(){return"@"+ ++a+"::"+ this.cid}}function n(a){var f=this.e=new m;f.cid=a;var d=f.chC;a=f.uid()+a;var c=new b(a);brc=function(a,b,c){f.brc(f["ch"+a],b,c)};this.register=function(a){f.reg(a,!0)};this.unregister=function(a){f.unr(a)};this.emitSignal=function(a,b){c.params=b;f.brc(d,a,c)}}this.root=a;var k={},h={};this.spawnCore=function(a){var b=new n(a);b.e.chE=function(a,b,f){for(var d in k)d.brc(a,b,f)};b.e.bb=this;return k[a]=b};this.destroyCore=function(a){k[a]&&(this.dispose(k[a]),delete k[a])};this.getCtx=function(a){return h[a]}; this.addContext=function(a,b){this.regCtx(a,b,null);this.root.addChild(b)};this.regCtx=function(a,b,d){h[a]&&alert("Context id:'"+a+"' is already registered.");h[a]=b;b.view=d;b.init();b.setID(a);return b};this.unrCtx=function(a){h[a]||alert("Context id:'"+a+"' doesn't exist.");var b=h[a];b&&b.parentNode&&(b.parentNode.removeChild(b),b.view=null,b.dispose());this.dispose(h[a]);delete h[a]}} BixBite.prototype.dispose=function(a){a.hasOwnProperty("destroy")&&a.destroy();for(var b in a)a.hasOwnProperty(b)&&delete a[b]};